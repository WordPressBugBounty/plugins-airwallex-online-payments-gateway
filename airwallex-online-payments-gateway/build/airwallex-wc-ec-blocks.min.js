(()=>{var e={21:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function i(e,t,n,o){return new(n||(n=Promise))((function(i,a){function r(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((o=o.apply(e,t||[])).next())}))}let a={};function r(e){const t=a[e];if(t)return t;const n=new Promise(((t,n)=>{const o=document.createElement("script");o.src=e,o.async=!0;const i=()=>{t()},r=()=>{o.removeEventListener("load",i),o.removeEventListener("error",r),delete a[e],o.remove(),n(new Error(`Unable to load script ${e}`))};o.addEventListener("load",i),o.addEventListener("error",r),document.body.appendChild(o)}));return a[e]=n,n}class s{constructor(e){this.handleClick=e=>i(this,void 0,void 0,(function*(){const t=this.config;if(!t)throw new Error("google-pay-button: Missing configuration");const n=this.createLoadPaymentDataRequest(t);try{if(t.onClick&&t.onClick(e),e.defaultPrevented)return;const o=yield this.client.loadPaymentData(n);t.onLoadPaymentData&&t.onLoadPaymentData(o)}catch(e){"CANCELED"===e.statusCode?t.onCancel&&t.onCancel(e):t.onError?t.onError(e):console.error(e)}})),this.options=e}getElement(){return this.element}isGooglePayLoaded(){var e,t;return"google"in(window||n.g)&&!!(null===(t=null===(e=null===google||void 0===google?void 0:google.payments)||void 0===e?void 0:e.api)||void 0===t?void 0:t.PaymentsClient)}mount(e){var t;return i(this,void 0,void 0,(function*(){if(!this.isGooglePayLoaded())try{yield r("https://pay.google.com/gp/p/js/pay.js")}catch(e){return void((null===(t=this.config)||void 0===t?void 0:t.onError)?this.config.onError(e):console.error(e))}this.element=e,e&&(this.appendStyles(),this.config&&this.updateElement())}))}unmount(){this.element=void 0}configure(e){let t;return this.config=e,this.oldInvalidationValues&&!this.isClientInvalidated(e)||(t=this.updateElement()),this.oldInvalidationValues=this.getInvalidationValues(e),null!=t?t:Promise.resolve()}createClientOptions(e){const t={environment:e.environment,merchantInfo:this.createMerchantInfo(e)};return(e.onPaymentDataChanged||e.onPaymentAuthorized)&&(t.paymentDataCallbacks={},e.onPaymentDataChanged&&(t.paymentDataCallbacks.onPaymentDataChanged=t=>e.onPaymentDataChanged(t)||{}),e.onPaymentAuthorized&&(t.paymentDataCallbacks.onPaymentAuthorized=t=>e.onPaymentAuthorized(t)||{})),t}createIsReadyToPayRequest(e){const t=e.paymentRequest;return{apiVersion:t.apiVersion,apiVersionMinor:t.apiVersionMinor,allowedPaymentMethods:t.allowedPaymentMethods,existingPaymentMethodRequired:e.existingPaymentMethodRequired}}createLoadPaymentDataRequest(e){return Object.assign(Object.assign({},e.paymentRequest),{merchantInfo:this.createMerchantInfo(e)})}createMerchantInfo(e){const t=Object.assign({},e.paymentRequest.merchantInfo);return t.softwareInfo||(t.softwareInfo={id:this.options.softwareInfoId,version:this.options.softwareInfoVersion}),t}isMounted(){return null!=this.element&&!1!==this.element.isConnected}removeButton(){if(this.element instanceof ShadowRoot||this.element instanceof Element)for(const e of Array.from(this.element.children))"STYLE"!==e.tagName&&e.remove()}updateElement(){return i(this,void 0,void 0,(function*(){if(!this.isMounted())return;const e=this.getElement();if(!this.config)throw new Error("google-pay-button: Missing configuration");this.removeButton();try{this.client=new google.payments.api.PaymentsClient(this.createClientOptions(this.config))}catch(e){return void(this.config.onError?this.config.onError(e):console.error(e))}const t={buttonType:this.config.buttonType,buttonColor:this.config.buttonColor,buttonRadius:this.config.buttonRadius,buttonSizeMode:this.config.buttonSizeMode,buttonLocale:this.config.buttonLocale,onClick:this.handleClick,allowedPaymentMethods:this.config.paymentRequest.allowedPaymentMethods},n=e.getRootNode();n instanceof ShadowRoot&&(t.buttonRootNode=n);const o=this.client.createButton(t);this.setClassName(e,[e.className,"not-ready"]),e.appendChild(o);let i,a=!1;try{i=yield this.client.isReadyToPay(this.createIsReadyToPayRequest(this.config)),a=i.result&&!this.config.existingPaymentMethodRequired||i.result&&i.paymentMethodPresent&&this.config.existingPaymentMethodRequired||!1}catch(e){this.config.onError?this.config.onError(e):console.error(e)}if(this.isMounted()){if(a){try{this.client.prefetchPaymentData(this.createLoadPaymentDataRequest(this.config))}catch(e){console.log("Error with prefetch",e)}this.setClassName(e,(e.className||"").split(" ").filter((e=>e&&"not-ready"!==e)))}if((this.isReadyToPay!==(null==i?void 0:i.result)||this.paymentMethodPresent!==(null==i?void 0:i.paymentMethodPresent))&&(this.isReadyToPay=!!(null==i?void 0:i.result),this.paymentMethodPresent=null==i?void 0:i.paymentMethodPresent,this.config.onReadyToPayChange)){const e={isButtonVisible:a,isReadyToPay:this.isReadyToPay};this.paymentMethodPresent&&(e.paymentMethodPresent=this.paymentMethodPresent),this.config.onReadyToPayChange(e)}}}))}setClassName(e,t){const n=t.filter((e=>e)).join(" ");n?e.className=n:e.removeAttribute("class")}appendStyles(){var e,t,n;if("undefined"==typeof document)return;const o=null===(e=this.element)||void 0===e?void 0:e.getRootNode(),i=`default-google-style-${this.options.cssSelector.replace(/[^\w-]+/g,"")}-${null===(t=this.config)||void 0===t?void 0:t.buttonLocale}`;if(o&&!(null===(n=o.getElementById)||void 0===n?void 0:n.call(o,i))){const e=document.createElement("style");e.id=i,e.type="text/css",e.innerHTML=`\n          ${this.options.cssSelector} {\n            display: inline-block;\n          }\n          ${this.options.cssSelector}.not-ready {\n            width: 0;\n            height: 0;\n            overflow: hidden;\n          }\n        `,o instanceof Document&&o.head?o.head.appendChild(e):o.appendChild(e)}}isClientInvalidated(e){return!this.oldInvalidationValues||this.getInvalidationValues(e).some(((e,t)=>JSON.stringify(e)!==JSON.stringify(this.oldInvalidationValues[t])))}getInvalidationValues(e){var t,n;return[e.environment,e.existingPaymentMethodRequired,!!e.onPaymentDataChanged,!!e.onPaymentAuthorized,e.buttonType,e.buttonColor,e.buttonRadius,e.buttonLocale,e.buttonSizeMode,e.paymentRequest.merchantInfo.merchantId,e.paymentRequest.merchantInfo.merchantName,null===(t=e.paymentRequest.merchantInfo.softwareInfo)||void 0===t?void 0:t.id,null===(n=e.paymentRequest.merchantInfo.softwareInfo)||void 0===n?void 0:n.version,e.paymentRequest.allowedPaymentMethods]}}const l="google-pay-button-container";class c extends o.default.Component{constructor(){super(...arguments),this.manager=new s({cssSelector:`.${l}`,softwareInfoId:"@google-pay/button-react",softwareInfoVersion:"3.1.0"}),this.elementRef=o.default.createRef()}componentDidMount(){return i(this,void 0,void 0,(function*(){const e=this.elementRef.current;e&&(yield this.manager.configure(this.props),yield this.manager.mount(e))}))}componentWillUnmount(){this.manager.unmount()}componentDidUpdate(){this.manager.configure(this.props)}render(){return o.default.createElement("div",{ref:this.elementRef,className:[l,this.props.className].filter((e=>e)).join(" "),style:this.props.style})}}return c}(n(609))},20:(e,t,n)=>{"use strict";var o=n(609),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function c(e,t,n){var o,a={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,o)&&!l.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===a[o]&&(a[o]=t[o]);return{$$typeof:i,type:e,key:c,ref:d,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c},848:(e,t,n)=>{"use strict";e.exports=n(20)},609:e=>{"use strict";e.exports=window.React}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wc.wcBlocksRegistry,t=window.wp.element,o=window.wc.wcSettings;window.wp.i18n;var i=n(21),a=n.n(i);const r=window.jQuery;var s=n.n(r);const l=(0,o.getSetting)("airwallex_express_checkout_data",{}),c=e=>l.ajaxUrl.toString().replace("%%endpoint%%","airwallex_"+e),d=e=>{var t,n,o,i;const a={security:l.nonce.shipping,country:null!==(t=e.countryCode)&&void 0!==t?t:"",state:null!==(n=e.administrativeArea)&&void 0!==n?n:"",postcode:null!==(o=e.postalCode)&&void 0!==o?o:"",city:null!==(i=e.locality)&&void 0!==i?i:""};return s().ajax({type:"POST",data:a,url:c("get_shipping_options")}).done((function(e){return e})).fail((function(e){return{success:!1,message:e}}))},u=(e,t)=>{for(let n in t)t[n]=e;const n={security:l.nonce.updateShipping,shippingMethods:t};return s().ajax({type:"POST",data:n,url:c("update_shipping_method")}).done((function(e){return e})).fail((function(e){return{success:!1,message:e}}))},p=(e,t)=>{const n="googlepay"===t?h(e):m(e);return s().ajax({type:"POST",data:n,url:c("create_order")}).done((function(e){return e})).fail((function(e){return e}))},h=e=>{const t=e.paymentMethodData.info.billingAddress,n=e.shippingAddress,o={billing_first_name:t?t.name.split(" ").slice(0,1).join(" "):"",billing_last_name:t?t.name.split(" ").slice(1).join(" "):"",billing_company:"",billing_email:e.email?e.email:"",billing_phone:t?t.phoneNumber:"",billing_country:t?t.countryCode:"",billing_address_1:t?t.address1:"",billing_address_2:t?t.address2.concat(" ",t.address3).trim():"",billing_city:t?t.locality:"",billing_state:t?t.administrativeArea:"",billing_postcode:t?t.postalCode:""},i={shipping_first_name:n?n.name.split(" ").slice(0,1).join(" "):"",shipping_last_name:n?n.name.split(" ").slice(1).join(" "):"",shipping_company:n&&n.organization?n.organization:"",shipping_country:n?n.countryCode:"",shipping_address_1:n?n.address1:"",shipping_address_2:n?n.address2.concat(" ",n.address3).trim():"",shipping_city:n?n.locality:"",shipping_state:n?n.administrativeArea:"",shipping_postcode:n?n.postalCode:"",shipping_method:[e.shippingOptionData?e.shippingOptionData.id:null]};return Object.assign({_wpnonce:l.nonce.checkout,order_comments:"",payment_method:"airwallex_express_checkout",ship_to_different_address:1,terms:1,payment_method_type:"googlepay"},o,i)},m=e=>{let t=e.billingContact;const n=e.shippingContact,o={billing_first_name:t?t.givenName:"",billing_last_name:t?t.familyName:"",billing_company:"",billing_email:t&&t.emailAddress?t.emailAddress:n?n.emailAddress:"",billing_phone:t&&t.phoneNumber?t.phoneNumber:n?n.phoneNumber:"",billing_country:t?t.countryCode:"",billing_address_1:t&&t.addressLines&&t.addressLines.length>0?t.addressLines.shift():"",billing_address_2:t&&t.addressLines?t.addressLines.join(" "):"",billing_city:t?t.locality?t.locality:t.administrativeArea:"",billing_state:t?t.administrativeArea:"",billing_postcode:t?t.postalCode:""},i={shipping_first_name:n?n.givenName:"",shipping_last_name:n?n.familyName:"",shipping_company:"",shipping_country:n?n.countryCode:"",shipping_address_1:n&&n.addressLines&&n.addressLines.length>0?n.addressLines.shift():"",shipping_address_2:n&&n.addressLines?n.addressLines.join(" "):"",shipping_city:n?n.locality?n.locality:n.administrativeArea:"",shipping_state:n?n.administrativeArea:"",shipping_postcode:n?n.postalCode:"",shipping_method:e.shippingMethods?e.shippingMethods:[null]};return Object.assign({_wpnonce:l.nonce.checkout,order_comments:"",payment_method:"airwallex_express_checkout",ship_to_different_address:1,terms:1,payment_method_type:"applepay"},o,i)},y=function(e=5e3){jQuery.blockUI({message:null,overlayCSS:{background:"#fff",opacity:.6}}),setTimeout((function(){jQuery.unblockUI()}),e)},g=function(){jQuery.unblockUI()},f=["email","name","phone","postalAddress"],w=e=>e?["email","name","phone","postalAddress"]:["email","phone"],_=e=>e.map((e=>({label:e.label,amount:e.price}))),v=(e,t)=>parseInt(e,10)/10**t,b={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",dev:"checkout-dev.airwallex.com",local:"localhost:3000"},P=e=>`https://${b[e]||b.prod}`,C="/assets/elements.bundle.min.js?version=1.89.0",I=e=>{const t=document.createElement("script");t.src=`${e}${C}`,t.crossOrigin="anonymous";const n=document.head||document.body;if(!n)throw new Error("Airwallex payment scripts requires a <head> or <body> html element in order to be loaded.");return n.appendChild(t),t},x=async e=>{if("undefined"==typeof window)return null;if(window.Airwallex)return window.Airwallex;let t=0;const n=async()=>{const t=document.querySelector(`script[src="${C}"], script[src="${C}/"]`)||I(P((null==e?void 0:e.env)||"prod"));return new Promise(((n,o)=>{t.addEventListener("load",(()=>{window.Airwallex?(window.Airwallex.init(e),n(window.Airwallex)):o(new Error("Failed to load Airwallex on load event"))})),t.addEventListener("error",(()=>{o(new Error("Failed to load Airwallex scripts")),t.remove&&t.remove()}))}))};for(;t<3;)try{return await n()}catch(e){t++,await new Promise((e=>window.setTimeout(e,500)))}return null},A=e=>{window.Airwallex?window.Airwallex.init(e):console.error("Please loadAirwallex() before init();")},R=(e,t)=>window.Airwallex?window.Airwallex.createElement(e,t):(console.error("Please loadAirwallex() before createElement();"),null),E=e=>window.Airwallex?window.Airwallex.destroyElement(e):(console.error("Please loadAirwallex() before destroyElement();"),!1);var S,M=n(848);const T=(0,o.getSetting)("airwallex_express_checkout_data",{}),L=e=>{const{checkout:t,transactionId:n}=T;return{amount:{value:e.orderInfo.total.amount||0,currency:e.currencyCode||t.currencyCode},transactionId:n,totalPriceLabel:t.totalPriceLabel,countryCode:e.countryCode||t.countryCode,displayItems:e.orderInfo.displayItems}},N=(e,t)=>{const{button:n,checkout:o,merchantInfo:i}=T;let a={mode:n.mode,buttonColor:n.theme,buttonType:n.buttonType,emailRequired:!0,billingAddressRequired:!0,billingAddressParameters:{format:"FULL",phoneNumberRequired:o.requiresPhone},merchantInfo:{merchantName:i.businessName},autoCapture:o.autoCapture},r=["PAYMENT_AUTHORIZATION"];t.needsShipping&&(r.push("SHIPPING_ADDRESS","SHIPPING_OPTION"),a.shippingAddressRequired=!0,a.shippingOptionRequired=!0,a.shippingAddressParameters={phoneNumberRequired:o.requiresPhone}),a.callbackIntents=r;const s=(e=>{const{checkout:t,transactionId:n}=T;return{amount:{value:v(e.cartTotal.value,e.currency.minorUnit)||0,currency:e.currency.code||t.currencyCode},transactionId:n,totalPriceLabel:t.totalPriceLabel,countryCode:t.countryCode,displayItems:[]}})(e);return a=Object.assign(a,s),a},k=e=>{const{locale:n,env:o}=T,{setExpressPaymentError:i,shippingData:a,billing:r,onError:s}=e;let l={};const c="googlePayButton",[h,m]=(0,t.useState)(),f=(0,t.useRef)(null),w=()=>{const e=R(c,N(r,a)),t=e.mount("awxGooglePayButton");m(t),f.current=e,f.current?.on("shippingAddressChange",(e=>{(async e=>{const{shippingAddress:t}=e.detail.intermediatePaymentData;let n={};const o=await d(t);var i;o&&o.success?(l={shippingMethods:o.shipping.shippingMethods,shippingOptions:(i=o.shipping.shippingOptions,i.map((e=>({id:e.id,label:e.label,description:e.description}))))},n.shippingOptionParameters={defaultSelectedOptionId:l.shippingMethods[0],shippingOptions:l.shippingOptions},n=Object.assign(n,L(o.cart))):(l=[],n.error={reason:"SHIPPING_ADDRESS_UNSERVICEABLE",message:o.message,intent:"SHIPPING_ADDRESS"}),f.current?.update(n)})(e)})),f.current?.on("shippingMethodChange",(e=>{(async e=>{const{shippingOptionData:t}=e.detail.intermediatePaymentData;let n={};const o=await u(t.id,l.shippingMethods);o&&o.success?n=L(o.cart):n.error={reason:"SHIPPING_OPTION_INVALID",message:o.message,intent:"SHIPPING_OPTION"},f.current?.update(n)})(e)})),f.current?.on("authorized",(e=>{(async e=>{const t=await p(e.detail.paymentData,"googlepay");if(y(5e4),"success"===t.result){const{createConsent:e,clientSecret:n,confirmationUrl:o}=t.payload;e?f.current?.createPaymentConsent({client_secret:n}).then((()=>{location.href=o})).catch((e=>{g(),s(e.message),console.warn(e.message)})):f.current?.confirmIntent({client_secret:n}).then((()=>{location.href=o})).catch((e=>{g(),s(e.message),console.warn(e.message)}))}else s(t.messages),console.warn(t.messages),g(),f.current?.confirmIntent({client_secret:""}).then((()=>{})).catch((e=>{console.warn(e)}))})(e)})),f.current?.on("error",(e=>{(e=>{const{error:t}=e.detail;s(t.detail),console.warn("There was an error",t)})(e)}))};return(0,t.useEffect)((()=>{"Airwallex"in window&&w()}),[]),(0,t.useEffect)((()=>{f.current&&(E(c),w())}),[r.cartTotal]),(0,M.jsx)("div",{id:"awxGooglePayButton",style:{marginTop:"-8px"}})},O=()=>{const{checkout:e,locale:t,button:n,merchantInfo:o}=T,i={apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:["MASTERCARD","VISA"]},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"airwallex",gatewayMerchantId:o.accountId||""}}}],merchantInfo:{merchantId:"BCR2DN4TWD5IRR2E",merchantName:o.businessName},transactionInfo:{totalPriceStatus:"FINAL",totalPriceLabel:e.totalPriceLabel,totalPrice:"0.00",currencyCode:e.currencyCode,countryCode:e.countryCode,displayItems:[]}};let r={buttonLocale:t,environment:"TEST",buttonSizeMode:"fill",buttonColor:n.theme,buttonType:n.buttonType,style:{width:"100%",height:n.height},paymentRequest:i,onClick:e=>{e.preventDefault()}};return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(a(),{...r})})},D={name:"airwallex_express_checkout_google_pay",content:(0,M.jsx)(k,{}),edit:(0,M.jsx)(O,{}),canMakePayment:({cartTotals:e})=>{var t;const{button:n,checkout:o}=T,i="recurring"===n.mode?"recurring":"oneoff";return null!==(t="0"!=e.total_price&&T?.googlePayEnabled&&i in o.allowedCardNetworks.googlepay&&o.allowedCardNetworks.googlepay[i].length>0)&&void 0!==t&&t},paymentMethodId:"airwallex_express_checkout",supports:{features:null!==(S=T?.supports)&&void 0!==S?S:[]}};var j;const q=(0,o.getSetting)("airwallex_express_checkout_data",{}),U=(e,t)=>e.map((e=>({label:e.label,amount:v(e.value,t)}))),V=e=>{const{checkout:n,isProductPage:o}=q,{shippingData:i,billing:a,onError:r}=e;let h={};const m="applePayButton",[b,P]=(0,t.useState)(),C=(0,t.useRef)(null),I=async e=>{o&&await addToCart();const t=await(e=>{const t={security:l.nonce.startPaymentSession,validationURL:e,origin:window.location.host};return s().ajax({type:"POST",data:t,url:c("start_payment_session")}).done((e=>e)).fail((e=>({success:!1,message:e})))})(e?.detail?.validationURL),{paymentSession:n,error:i}=t;n?C.current?.completeValidation(n):C.current?.fail(i)},x=()=>{const e=R(m,((e,t)=>{const{cartTotal:n,currency:o,cartTotalItems:i}=e,{button:a,checkout:r}=q,{needsShipping:s}=t;return{mode:a.mode,buttonColor:a.theme,buttonType:a.buttonType,origin:window.location.origin,totalPriceLabel:r.totalPriceLabel,countryCode:r.countryCode,requiredBillingContactFields:f,requiredShippingContactFields:w(s),amount:{value:n.value?v(n.value,o.minorUnit):0,currency:o.code?o.code:r.currencyCode},lineItems:U(i,o.minorUnit),autoCapture:r.autoCapture}})(a,i)),t=e.mount("awxApplePayButton");P(t),C.current=e,C.current?.on("validateMerchant",(e=>{I(e)})),C.current?.on("shippingAddressChange",(e=>{(async e=>{if(i.needsShipping){const o=await d(e?.detail?.shippingAddress);if(o&&o.success){const{shipping:e,cart:i}=o;h=e.shippingMethods,C.current?.update({amount:{value:i?.orderInfo?.total?.amount||0},totalPriceLabel:n.totalPriceLabel,lineItems:_(i.orderInfo.displayItems),shippingMethods:(t=e.shippingOptions,t.map((e=>({identifier:e.id,label:e.label,detail:e.description,amount:e.amount}))))})}else h=[],console.warn(o.message),C.current?.fail({message:o.message})}else C.current?.update({amount:{value:a?.cartTotal?.value?v(a?.cartTotal?.value,a.currency.minorUnit):0},totalPriceLabel:n.totalPriceLabel,lineItems:U(a.cartTotalItems,a.currency.minorUnit)});var t})(e)})),C.current?.on("shippingMethodChange",(e=>{(async e=>{const t=await u(e.detail.shippingMethod.identifier,h);if(t&&t.success){const{cart:e}=t;C.current?.update({amount:{value:e?.orderInfo?.total?.amount||0},totalPriceLabel:n.totalPriceLabel,lineItems:_(e.orderInfo.displayItems)})}else console.warn(t.message),C.current?.fail({message:t.message})})(e)})),C.current?.on("authorized",(e=>{(async e=>{let t=e?.detail?.paymentData||{};t.shippingMethods=h;const n=await p(t,"applepay");if(y(5e4),"success"===n.result){const{createConsent:e,clientSecret:t,confirmationUrl:o}=n.payload;e?C.current?.createPaymentConsent({client_secret:t}).then((()=>{location.href=o})).catch((e=>{g(),r(e.message),console.warn(e.message)})):C.current?.confirmIntent({client_secret:t}).then((()=>{location.href=o})).catch((e=>{g(),r(e.message),console.warn(e.message)}))}else r(n.messages),console.warn(n.messages),g(),C.current?.confirmIntent({client_secret:""}).then((()=>{})).catch((e=>{console.warn(e)}))})(e)})),C.current?.on("error",(e=>{(e=>{const{error:t}=e.detail;r(t.detail),console.warn("There was an error",t)})(e)}))};return(0,t.useEffect)((()=>{"Airwallex"in window&&x()}),[]),(0,t.useEffect)((()=>{C.current&&(E(m),x())}),[a.cartTotal]),(0,M.jsx)("div",{id:"awxApplePayButton"})},B=e=>{const{checkout:n,locale:o,button:i}=q;return(0,t.useEffect)((()=>{if("Airwallex"in window){R("applePayButton",{mode:i.mode,buttonColor:i.theme,buttonType:i.buttonType,origin:window.location.origin,totalPriceLabel:n.totalPriceLabel,countryCode:n.countryCode,requiredBillingContactFields:f,requiredShippingContactFields:w,amount:{value:0,currency:n.currencyCode}}).mount("awxApplePayButtonPreview")}}),[]),(0,M.jsx)("div",{id:"awxApplePayButtonPreview"})},z={name:"airwallex_express_checkout_apple_pay",content:(0,M.jsx)(V,{}),edit:(0,M.jsx)(B,{}),canMakePayment:({cartTotals:e})=>{var t;const{button:n,checkout:o}=q,i="recurring"===n.mode?"recurring":"oneoff";return null!==(t="0"!=e.total_price&&q.applePayEnabled&&i in o.allowedCardNetworks.applepay&&o.allowedCardNetworks.applepay[i].length>0&&(()=>{try{return"ApplePaySession"in window&&ApplePaySession?.supportsVersion(4)&&ApplePaySession?.canMakePayments()}catch{console.error("ApplePaySession is not supported in iframe")}})())&&void 0!==t&&t},paymentMethodId:"airwallex_express_checkout",supports:{features:null!==(j=q?.supports)&&void 0!==j?j:[]}},$=(0,o.getSetting)("airwallex_express_checkout_data",{}),{locale:F,env:G}=$;x({env:G,locale:F,origin:window.location.origin}).then((()=>{A({env:$.env}),(0,e.registerExpressPaymentMethod)(z),(0,e.registerExpressPaymentMethod)(D)}))})()})();