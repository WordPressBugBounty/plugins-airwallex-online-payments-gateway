(()=>{var e={21:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function a(e,t,n,o){return new(n||(n=Promise))((function(a,i){function r(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((o=o.apply(e,t||[])).next())}))}let i={};function r(e){const t=i[e];if(t)return t;const n=new Promise(((t,n)=>{const o=document.createElement("script");o.src=e,o.async=!0;const a=()=>{t()},r=()=>{o.removeEventListener("load",a),o.removeEventListener("error",r),delete i[e],o.remove(),n(new Error(`Unable to load script ${e}`))};o.addEventListener("load",a),o.addEventListener("error",r),document.body.appendChild(o)}));return i[e]=n,n}class s{constructor(e){this.handleClick=e=>a(this,void 0,void 0,(function*(){const t=this.config;if(!t)throw new Error("google-pay-button: Missing configuration");const n=this.createLoadPaymentDataRequest(t);try{if(t.onClick&&t.onClick(e),e.defaultPrevented)return;const o=yield this.client.loadPaymentData(n);t.onLoadPaymentData&&t.onLoadPaymentData(o)}catch(e){"CANCELED"===e.statusCode?t.onCancel&&t.onCancel(e):t.onError?t.onError(e):console.error(e)}})),this.options=e}getElement(){return this.element}isGooglePayLoaded(){var e,t;return"google"in(window||n.g)&&!!(null===(t=null===(e=null===google||void 0===google?void 0:google.payments)||void 0===e?void 0:e.api)||void 0===t?void 0:t.PaymentsClient)}mount(e){var t;return a(this,void 0,void 0,(function*(){if(!this.isGooglePayLoaded())try{yield r("https://pay.google.com/gp/p/js/pay.js")}catch(e){return void((null===(t=this.config)||void 0===t?void 0:t.onError)?this.config.onError(e):console.error(e))}this.element=e,e&&(this.appendStyles(),this.config&&this.updateElement())}))}unmount(){this.element=void 0}configure(e){let t;return this.config=e,this.oldInvalidationValues&&!this.isClientInvalidated(e)||(t=this.updateElement()),this.oldInvalidationValues=this.getInvalidationValues(e),null!=t?t:Promise.resolve()}createClientOptions(e){const t={environment:e.environment,merchantInfo:this.createMerchantInfo(e)};return(e.onPaymentDataChanged||e.onPaymentAuthorized)&&(t.paymentDataCallbacks={},e.onPaymentDataChanged&&(t.paymentDataCallbacks.onPaymentDataChanged=t=>e.onPaymentDataChanged(t)||{}),e.onPaymentAuthorized&&(t.paymentDataCallbacks.onPaymentAuthorized=t=>e.onPaymentAuthorized(t)||{})),t}createIsReadyToPayRequest(e){const t=e.paymentRequest;return{apiVersion:t.apiVersion,apiVersionMinor:t.apiVersionMinor,allowedPaymentMethods:t.allowedPaymentMethods,existingPaymentMethodRequired:e.existingPaymentMethodRequired}}createLoadPaymentDataRequest(e){return Object.assign(Object.assign({},e.paymentRequest),{merchantInfo:this.createMerchantInfo(e)})}createMerchantInfo(e){const t=Object.assign({},e.paymentRequest.merchantInfo);return t.softwareInfo||(t.softwareInfo={id:this.options.softwareInfoId,version:this.options.softwareInfoVersion}),t}isMounted(){return null!=this.element&&!1!==this.element.isConnected}removeButton(){if(this.element instanceof ShadowRoot||this.element instanceof Element)for(const e of Array.from(this.element.children))"STYLE"!==e.tagName&&e.remove()}updateElement(){return a(this,void 0,void 0,(function*(){if(!this.isMounted())return;const e=this.getElement();if(!this.config)throw new Error("google-pay-button: Missing configuration");this.removeButton();try{this.client=new google.payments.api.PaymentsClient(this.createClientOptions(this.config))}catch(e){return void(this.config.onError?this.config.onError(e):console.error(e))}const t={buttonType:this.config.buttonType,buttonColor:this.config.buttonColor,buttonRadius:this.config.buttonRadius,buttonSizeMode:this.config.buttonSizeMode,buttonLocale:this.config.buttonLocale,onClick:this.handleClick,allowedPaymentMethods:this.config.paymentRequest.allowedPaymentMethods},n=e.getRootNode();n instanceof ShadowRoot&&(t.buttonRootNode=n);const o=this.client.createButton(t);this.setClassName(e,[e.className,"not-ready"]),e.appendChild(o);let a,i=!1;try{a=yield this.client.isReadyToPay(this.createIsReadyToPayRequest(this.config)),i=a.result&&!this.config.existingPaymentMethodRequired||a.result&&a.paymentMethodPresent&&this.config.existingPaymentMethodRequired||!1}catch(e){this.config.onError?this.config.onError(e):console.error(e)}if(this.isMounted()){if(i){try{this.client.prefetchPaymentData(this.createLoadPaymentDataRequest(this.config))}catch(e){console.log("Error with prefetch",e)}this.setClassName(e,(e.className||"").split(" ").filter((e=>e&&"not-ready"!==e)))}if((this.isReadyToPay!==(null==a?void 0:a.result)||this.paymentMethodPresent!==(null==a?void 0:a.paymentMethodPresent))&&(this.isReadyToPay=!!(null==a?void 0:a.result),this.paymentMethodPresent=null==a?void 0:a.paymentMethodPresent,this.config.onReadyToPayChange)){const e={isButtonVisible:i,isReadyToPay:this.isReadyToPay};this.paymentMethodPresent&&(e.paymentMethodPresent=this.paymentMethodPresent),this.config.onReadyToPayChange(e)}}}))}setClassName(e,t){const n=t.filter((e=>e)).join(" ");n?e.className=n:e.removeAttribute("class")}appendStyles(){var e,t,n;if("undefined"==typeof document)return;const o=null===(e=this.element)||void 0===e?void 0:e.getRootNode(),a=`default-google-style-${this.options.cssSelector.replace(/[^\w-]+/g,"")}-${null===(t=this.config)||void 0===t?void 0:t.buttonLocale}`;if(o&&!(null===(n=o.getElementById)||void 0===n?void 0:n.call(o,a))){const e=document.createElement("style");e.id=a,e.type="text/css",e.innerHTML=`\n          ${this.options.cssSelector} {\n            display: inline-block;\n          }\n          ${this.options.cssSelector}.not-ready {\n            width: 0;\n            height: 0;\n            overflow: hidden;\n          }\n        `,o instanceof Document&&o.head?o.head.appendChild(e):o.appendChild(e)}}isClientInvalidated(e){return!this.oldInvalidationValues||this.getInvalidationValues(e).some(((e,t)=>JSON.stringify(e)!==JSON.stringify(this.oldInvalidationValues[t])))}getInvalidationValues(e){var t,n;return[e.environment,e.existingPaymentMethodRequired,!!e.onPaymentDataChanged,!!e.onPaymentAuthorized,e.buttonType,e.buttonColor,e.buttonRadius,e.buttonLocale,e.buttonSizeMode,e.paymentRequest.merchantInfo.merchantId,e.paymentRequest.merchantInfo.merchantName,null===(t=e.paymentRequest.merchantInfo.softwareInfo)||void 0===t?void 0:t.id,null===(n=e.paymentRequest.merchantInfo.softwareInfo)||void 0===n?void 0:n.version,e.paymentRequest.allowedPaymentMethods]}}const l="google-pay-button-container";class c extends o.default.Component{constructor(){super(...arguments),this.manager=new s({cssSelector:`.${l}`,softwareInfoId:"@google-pay/button-react",softwareInfoVersion:"3.1.0"}),this.elementRef=o.default.createRef()}componentDidMount(){return a(this,void 0,void 0,(function*(){const e=this.elementRef.current;e&&(yield this.manager.configure(this.props),yield this.manager.mount(e))}))}componentWillUnmount(){this.manager.unmount()}componentDidUpdate(){this.manager.configure(this.props)}render(){return o.default.createElement("div",{ref:this.elementRef,className:[l,this.props.className].filter((e=>e)).join(" "),style:this.props.style})}}return c}(n(609))},20:(e,t,n)=>{"use strict";var o=n(609),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function c(e,t,n){var o,i={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,o)&&!l.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:a,type:e,key:c,ref:d,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c},848:(e,t,n)=>{"use strict";e.exports=n(20)},609:e=>{"use strict";e.exports=window.React}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wc.wcBlocksRegistry,t=window.wp.element,o={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",dev:"checkout-dev.airwallex.com",local:"localhost:3000"},a=e=>`https://${o[e]||o.prod}`,i="/assets/elements.bundle.min.js?version=1.89.0",r=e=>{const t=document.createElement("script");t.src=`${e}${i}`,t.crossOrigin="anonymous";const n=document.head||document.body;if(!n)throw new Error("Airwallex payment scripts requires a <head> or <body> html element in order to be loaded.");return n.appendChild(t),t},s=async e=>{if("undefined"==typeof window)return null;if(window.Airwallex)return window.Airwallex;let t=0;const n=async()=>{const t=document.querySelector(`script[src="${i}"], script[src="${i}/"]`)||r(a((null==e?void 0:e.env)||"prod"));return new Promise(((n,o)=>{t.addEventListener("load",(()=>{window.Airwallex?(window.Airwallex.init(e),n(window.Airwallex)):o(new Error("Failed to load Airwallex on load event"))})),t.addEventListener("error",(()=>{o(new Error("Failed to load Airwallex scripts")),t.remove&&t.remove()}))}))};for(;t<3;)try{return await n()}catch(e){t++,await new Promise((e=>window.setTimeout(e,500)))}return null},l=(e,t)=>window.Airwallex?window.Airwallex.createElement(e,t):(console.error("Please loadAirwallex() before createElement();"),null),c=e=>window.Airwallex?window.Airwallex.destroyElement(e):(console.error("Please loadAirwallex() before destroyElement();"),!1);const d=window.wc.wcSettings;window.wp.i18n;var u=n(21),p=n.n(u);const m=window.jQuery;var h=n.n(m);const g=(0,d.getSetting)("airwallex_express_checkout_data",{}),y=e=>g.ajaxUrl.toString().replace("%%endpoint%%","airwallex_"+e),f=e=>{var t,n,o,a;const i={security:g.nonce.shipping,country:null!==(t=e.countryCode)&&void 0!==t?t:"",state:null!==(n=e.administrativeArea)&&void 0!==n?n:"",postcode:null!==(o=e.postalCode)&&void 0!==o?o:"",city:null!==(a=e.locality)&&void 0!==a?a:""};return h().ajax({type:"POST",data:i,url:y("get_shipping_options")}).done((function(e){return e})).fail((function(e){return{success:!1,message:e}}))},w=(e,t)=>{for(let n in t)t[n]=e;const n={security:g.nonce.updateShipping,shippingMethods:t};return h().ajax({type:"POST",data:n,url:y("update_shipping_method")}).done((function(e){return e})).fail((function(e){return{success:!1,message:e}}))},_=(e,t)=>{const n="googlepay"===t?x(e):v(e);return h().ajax({type:"POST",data:n,url:y("create_order")}).done((function(e){return e})).fail((function(e){return e}))},x=e=>{const t=e.paymentMethodData.info.billingAddress,n=e.shippingAddress,o={billing_first_name:t?t.name.split(" ").slice(0,1).join(" "):"",billing_last_name:t?t.name.split(" ").slice(1).join(" "):"",billing_company:"",billing_email:e.email?e.email:"",billing_phone:t?t.phoneNumber:"",billing_country:t?t.countryCode:"",billing_address_1:t?t.address1:"",billing_address_2:t?t.address2.concat(" ",t.address3).trim():"",billing_city:t?t.locality:"",billing_state:t?t.administrativeArea:"",billing_postcode:t?t.postalCode:""},a={shipping_first_name:n?n.name.split(" ").slice(0,1).join(" "):"",shipping_last_name:n?n.name.split(" ").slice(1).join(" "):"",shipping_company:n&&n.organization?n.organization:"",shipping_country:n?n.countryCode:"",shipping_address_1:n?n.address1:"",shipping_address_2:n?n.address2.concat(" ",n.address3).trim():"",shipping_city:n?n.locality:"",shipping_state:n?n.administrativeArea:"",shipping_postcode:n?n.postalCode:"",shipping_method:[e.shippingOptionData?e.shippingOptionData.id:null]};return Object.assign({_wpnonce:g.nonce.checkout,order_comments:"",payment_method:"airwallex_express_checkout",ship_to_different_address:1,terms:1,payment_method_type:"googlepay"},o,a)},v=e=>{let t=e.billingContact;const n=e.shippingContact,o={billing_first_name:t?t.givenName:"",billing_last_name:t?t.familyName:"",billing_company:"",billing_email:t&&t.emailAddress?t.emailAddress:n?n.emailAddress:"",billing_phone:t&&t.phoneNumber?t.phoneNumber:n?n.phoneNumber:"",billing_country:t?t.countryCode:"",billing_address_1:t&&t.addressLines&&t.addressLines.length>0?t.addressLines.shift():"",billing_address_2:t&&t.addressLines?t.addressLines.join(" "):"",billing_city:t?t.locality?t.locality:t.administrativeArea:"",billing_state:t?t.administrativeArea:"",billing_postcode:t?t.postalCode:""},a={shipping_first_name:n?n.givenName:"",shipping_last_name:n?n.familyName:"",shipping_company:"",shipping_country:n?n.countryCode:"",shipping_address_1:n&&n.addressLines&&n.addressLines.length>0?n.addressLines.shift():"",shipping_address_2:n&&n.addressLines?n.addressLines.join(" "):"",shipping_city:n?n.locality?n.locality:n.administrativeArea:"",shipping_state:n?n.administrativeArea:"",shipping_postcode:n?n.postalCode:"",shipping_method:e.shippingMethods?e.shippingMethods:[null]};return Object.assign({_wpnonce:g.nonce.checkout,order_comments:"",payment_method:"airwallex_express_checkout",ship_to_different_address:1,terms:1,payment_method_type:"applepay"},o,a)},b=function(e=5e3){jQuery.blockUI({message:null,overlayCSS:{background:"#fff",opacity:.6}}),setTimeout((function(){jQuery.unblockUI()}),e)},P=function(){jQuery.unblockUI()},C=["email","name","phone","postalAddress"],I=e=>e?["email","name","phone","postalAddress"]:["email","phone"],E=e=>e.map((e=>({label:e.label,amount:e.price}))),S=(e,t)=>parseInt(e,10)/10**t,A=(e,t,n,o)=>{jQuery.ajax({url:awxCommonData.updateOrderStatusAfterPaymentDecline.url+"&security="+awxCommonData.updateOrderStatusAfterPaymentDecline.nonce+"&order_id="+e.order_id,method:"GET",dataType:"json",success:function(e){let a=e.success?t.message||"":e.message;n(),o(a),console.warn(a)},error:function(e,t,a){let i=e.responseText;e.responseJSON&&e.responseJSON.message&&(i=e.responseJSON.message),n(),o(i),console.warn(i)}})},R=async()=>{if(!awxCommonData.getExpressCheckoutData.allowedCardNetworks)try{const e=await h().ajax({url:awxCommonData.getExpressCheckoutData.url+"&security="+awxCommonData.getExpressCheckoutData.nonce,method:"GET",dataType:"json"}).done((function(e){return e})).fail((function(e){return e}));awxCommonData.getExpressCheckoutData.allowedCardNetworks=e?.data?.allowedCardNetworks}catch(e){return console.error("Failed to get express checkout data:",e),null}return awxCommonData.getExpressCheckoutData.allowedCardNetworks};(()=>{const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))})();const D=e=>{let t=e.map((function(e){return"unionpay"===e?"chinaUnionPay":"mastercard"===e?"masterCard":e})).filter((function(e){return"diners"!==e}));return-1!==t.indexOf("masterCard")&&-1===t.indexOf("maestro")&&t.push("maestro"),t};var k,M=n(848);const N=(0,d.getSetting)("airwallex_express_checkout_data",{});N.checkout=awxCommonData.getExpressCheckoutData.checkout;const T=awxCommonData.getExpressCheckoutData.hasSubscriptionProduct?"recurring":"oneoff",L=e=>{const{checkout:t,transactionId:n}=N;return{amount:{value:e.orderInfo.total.amount||0,currency:e.currencyCode||t.currencyCode},transactionId:n,totalPriceLabel:t.totalPriceLabel,countryCode:e.countryCode||t.countryCode,displayItems:e.orderInfo.displayItems}},O=(e,t,n)=>{const{button:o,checkout:a,merchantInfo:i}=N;let r={mode:T,buttonColor:o.theme,buttonType:o.buttonType,emailRequired:!0,billingAddressRequired:!(a.isVirtualPurchase&&a.isSkipBillingForVirtual),billingAddressParameters:{format:"FULL",phoneNumberRequired:a.requiresPhone},merchantInfo:{merchantName:i.businessName},autoCapture:a.autoCapture,allowedCardNetworks:(s=n.googlepay[T],s.map((function(e){return e.toUpperCase()})).filter((function(e){return"UNIONPAY"!==e&&"MAESTRO"!==e&&"DINERS"!==e})))};var s;let l=["PAYMENT_AUTHORIZATION"];t.needsShipping&&(l.push("SHIPPING_ADDRESS","SHIPPING_OPTION"),r.shippingAddressRequired=!0,r.shippingOptionRequired=!0,r.shippingAddressParameters={phoneNumberRequired:a.requiresPhone}),r.callbackIntents=l;const c=(e=>{const{checkout:t,transactionId:n}=N;return{amount:{value:S(e.cartTotal.value,e.currency.minorUnit)||0,currency:e.currency.code||t.currencyCode},transactionId:n,totalPriceLabel:t.totalPriceLabel,countryCode:t.countryCode,displayItems:[]}})(e);return r=Object.assign(r,c),r},j=e=>{const{locale:n,env:o}=N,{setExpressPaymentError:a,shippingData:i,billing:r,onError:d}=e;let u={};const p="googlePayButton",[m,h]=(0,t.useState)(),[g,y]=(0,t.useState)(null),x=(0,t.useRef)(null),v=()=>{if(!g)return;const e=l(p,O(r,i,g)),t=e.mount("awxGooglePayButton");h(t),x.current=e,x.current?.on("shippingAddressChange",(e=>{(async e=>{const{shippingAddress:t}=e.detail.intermediatePaymentData;let n={};const o=await f(t);var a;o&&o.success?(u={shippingMethods:o.shipping.shippingMethods,shippingOptions:(a=o.shipping.shippingOptions,a.map((e=>({id:e.id,label:e.label,description:e.description}))))},n.shippingOptionParameters={defaultSelectedOptionId:u.shippingMethods[0],shippingOptions:u.shippingOptions},n=Object.assign(n,L(o.cart))):(u=[],n.error={reason:"SHIPPING_ADDRESS_UNSERVICEABLE",message:o.message,intent:"SHIPPING_ADDRESS"}),x.current?.update(n)})(e)})),x.current?.on("shippingMethodChange",(e=>{(async e=>{const{shippingOptionData:t}=e.detail.intermediatePaymentData;let n={};const o=await w(t.id,u.shippingMethods);o&&o.success?n=L(o.cart):n.error={reason:"SHIPPING_OPTION_INVALID",message:o.message,intent:"SHIPPING_OPTION"},x.current?.update(n)})(e)})),x.current?.on("authorized",(e=>{(async e=>{const t=await _(e.detail.paymentData,"googlepay");if(t.redirect_url)location.href=t.redirect_url;else if(b(5e4),"success"===t.result){const{createConsent:e,clientSecret:n,confirmationUrl:o}=t.payload;e?x.current?.confirmIntent({client_secret:n,payment_consent:{next_triggered_by:"merchant",merchant_trigger_reason:"scheduled"}}).then((()=>{location.href=o})).catch((e=>{A(t,e,P,d)})):x.current?.confirmIntent({client_secret:n}).then((()=>{location.href=o})).catch((e=>{A(t,e,P,d)}))}else d(t.messages),console.warn(t.messages),P(),x.current?.confirmIntent({client_secret:""}).then((()=>{})).catch((e=>{console.warn(e)}))})(e)})),x.current?.on("error",(e=>{(e=>{const{error:t}=e.detail;d(t.detail),console.warn("There was an error",t)})(e)}))};return(0,t.useEffect)((()=>{(async()=>{let e={env:awxCommonData.env,locale:awxCommonData.locale,origin:window.location.origin};await s(e),Airwallex.init(e);const t=await R();y(t)})()}),[]),(0,t.useEffect)((()=>{g&&v()}),[g]),(0,t.useEffect)((()=>{x.current&&(c(p),v())}),[r.cartTotal]),(0,M.jsx)("div",{id:"awxGooglePayButton"})},q=()=>{const{checkout:e,locale:t,button:n,merchantInfo:o}=N,a={apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:["MASTERCARD","VISA"]},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"airwallex",gatewayMerchantId:o.accountId||""}}}],merchantInfo:{merchantId:"BCR2DN4TWD5IRR2E",merchantName:o.businessName},transactionInfo:{totalPriceStatus:"FINAL",totalPriceLabel:e.totalPriceLabel,totalPrice:"0.00",currencyCode:e.currencyCode,countryCode:e.countryCode,displayItems:[]}};let i={buttonLocale:t,environment:"TEST",buttonSizeMode:"fill",buttonColor:n.theme,buttonType:n.buttonType,style:{width:"100%",height:n.height},paymentRequest:a,onClick:e=>{e.preventDefault()}};return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(p(),{...i})})},U={name:"airwallex_express_checkout_google_pay",content:(0,M.jsx)(j,{}),edit:(0,M.jsx)(q,{}),canMakePayment:()=>!!N?.googlePayEnabled,paymentMethodId:"airwallex_express_checkout",supports:{features:null!==(k=N?.supports)&&void 0!==k?k:[]}};var V;const B=(0,d.getSetting)("airwallex_express_checkout_data",{});B.checkout=awxCommonData.getExpressCheckoutData.checkout;const F=awxCommonData.getExpressCheckoutData.hasSubscriptionProduct?"recurring":"oneoff",z=(e,t)=>e.map((e=>({label:e.label,amount:S(e.value,t)}))),G=e=>{const{checkout:n,isProductPage:o}=B,{shippingData:a,billing:i,onError:r}=e;let d={};const u="applePayButton",[p,m]=(0,t.useState)(),[x,v]=(0,t.useState)(null),k=(0,t.useRef)(null),N=async e=>{o&&await addToCart();const t=await(e=>{const t={security:g.nonce.startPaymentSession,validationURL:e,origin:window.location.host};return h().ajax({type:"POST",data:t,url:y("start_payment_session")}).done((e=>e)).fail((e=>({success:!1,message:e})))})(e?.detail?.validationURL),{paymentSession:n,error:a}=t;n?k.current?.completeValidation(n):k.current?.fail(a)},T=()=>{if(!x)return;const e=l(u,((e,t,n)=>{const{cartTotal:o,currency:a,cartTotalItems:i}=e,{button:r,checkout:s}=B,{needsShipping:l}=t;return{mode:F,buttonColor:r.theme,buttonType:r.buttonType,origin:window.location.origin,totalPriceLabel:s.totalPriceLabel,countryCode:s.countryCode,requiredBillingContactFields:s.isVirtualPurchase&&s.isSkipBillingForVirtual?C.filter((e=>"postalAddress"!==e)):C,requiredShippingContactFields:I(l),amount:{value:o.value?S(o.value,a.minorUnit):0,currency:a.code?a.code:s.currencyCode},lineItems:z(i,a.minorUnit),autoCapture:s.autoCapture,supportedNetworks:D(n.applepay[F])}})(i,a,x)),t=e.mount("awxApplePayButton");m(t),k.current=e,k.current?.on("validateMerchant",(e=>{N(e)})),k.current?.on("shippingAddressChange",(e=>{(async e=>{if(a.needsShipping){const o=await f(e?.detail?.shippingAddress);if(o&&o.success){const{shipping:e,cart:a}=o;d=e.shippingMethods,k.current?.update({amount:{value:a?.orderInfo?.total?.amount||0},totalPriceLabel:n.totalPriceLabel,lineItems:E(a.orderInfo.displayItems),shippingMethods:(t=e.shippingOptions,t.map((e=>({identifier:e.id,label:e.label,detail:e.description,amount:e.amount}))))})}else d=[],console.warn(o.message),k.current?.fail({message:o.message})}else k.current?.update({amount:{value:i?.cartTotal?.value?S(i?.cartTotal?.value,i.currency.minorUnit):0},totalPriceLabel:n.totalPriceLabel,lineItems:z(i.cartTotalItems,i.currency.minorUnit)});var t})(e)})),k.current?.on("shippingMethodChange",(e=>{(async e=>{const t=await w(e.detail.shippingMethod.identifier,d);if(t&&t.success){const{cart:e}=t;k.current?.update({amount:{value:e?.orderInfo?.total?.amount||0},totalPriceLabel:n.totalPriceLabel,lineItems:E(e.orderInfo.displayItems)})}else console.warn(t.message),k.current?.fail({message:t.message})})(e)})),k.current?.on("authorized",(e=>{(async e=>{let t=e?.detail?.paymentData||{};t.shippingMethods=d;const n=await _(t,"applepay");if(n.redirect_url)location.href=n.redirect_url;else if(b(5e4),"success"===n.result){const{createConsent:e,clientSecret:t,confirmationUrl:o}=n.payload;e?k.current?.confirmIntent({client_secret:t,payment_consent:{next_triggered_by:"merchant",merchant_trigger_reason:"scheduled"}}).then((()=>{location.href=o})).catch((e=>{A(n,e,P,r)})):k.current?.confirmIntent({client_secret:t}).then((()=>{location.href=o})).catch((e=>{A(n,e,P,r)}))}else r(n.messages),console.warn(n.messages),P(),k.current?.confirmIntent({client_secret:""}).then((()=>{})).catch((e=>{console.warn(e)}))})(e)})),k.current?.on("error",(e=>{(e=>{const{error:t}=e.detail;r(t.detail),console.warn("There was an error",t)})(e)}))};return(0,t.useEffect)((()=>{(async()=>{let e={env:awxCommonData.env,locale:awxCommonData.locale,origin:window.location.origin};await s(e),Airwallex.init(e);const t=await R();v(t)})()}),[]),(0,t.useEffect)((()=>{x&&T()}),[x]),(0,t.useEffect)((()=>{k.current&&(c(u),T())}),[i.cartTotal]),(0,M.jsx)("div",{id:"awxApplePayButton"})},$=e=>{const{checkout:n,locale:o,button:a}=B;return(0,t.useEffect)((()=>{if("Airwallex"in window){l("applePayButton",{mode:F,buttonColor:a.theme,buttonType:a.buttonType,origin:window.location.origin,totalPriceLabel:n.totalPriceLabel,countryCode:n.countryCode,requiredBillingContactFields:C,requiredShippingContactFields:I,amount:{value:0,currency:n.currencyCode}}).mount("awxApplePayButtonPreview")}}),[]),(0,M.jsx)("div",{id:"awxApplePayButtonPreview"})},H={name:"airwallex_express_checkout_apple_pay",content:(0,M.jsx)(G,{}),edit:(0,M.jsx)($,{}),canMakePayment:()=>!!B?.applePayEnabled,paymentMethodId:"airwallex_express_checkout",supports:{features:null!==(V=B?.supports)&&void 0!==V?V:[]}};(0,e.registerExpressPaymentMethod)(H),(0,e.registerExpressPaymentMethod)(U)})()})();