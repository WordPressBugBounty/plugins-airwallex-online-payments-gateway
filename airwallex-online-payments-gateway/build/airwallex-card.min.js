(()=>{"use strict";"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const r=16*Math.random()|0;return("x"===e?r:3&r|8).toString(16)}));jQuery((function(e){const{env:r,locale:t,confirmationUrl:a,isOrderPayPage:n}=awxCommonData,o=n?"#order_review":"form.checkout",{autoCapture:l,errorMessage:c,incompleteMessage:i}=awxEmbeddedCardData,d=()=>{const r=Airwallex.createElement("card",{autoCapture:l,allowedCardNetworks:["discover","visa","mastercard","maestro","unionpay","amex","jcb","diners"]});let t=r.mount("airwallex-card");setInterval((function(){if(document.getElementById("airwallex-card")&&!document.querySelector("#airwallex-card iframe"))try{t=r.mount("airwallex-card")}catch(e){console.warn(e)}}),1e3),window.addEventListener("onError",(e=>{if(!e.detail)return;const{error:r}=e.detail;AirwallexClient.displayCheckoutError(o,String(c).replace("%s",r.message||""))})),e("form.checkout").on("checkout_place_order_success",(function(t,a,n){return"airwallex_card"===e('[name="payment_method"]:checked').val()&&x(a,r),!0})),e(document.body).on("click","#place_order",(function(t){const a=e('[name="payment_method"]:checked').val();awxCommonData.isOrderPayPage&&"airwallex_card"===a&&(s("#order_review"),t.preventDefault(),e.ajax({type:"POST",data:e("#order_review").serialize(),url:awxCommonData.processOrderPayUrl}).done((t=>{"success"===t.result?t.redirect?location.href=t.redirect:x(t,r):(console.warn(t.error),e("#order_review").unblock(),AirwallexClient.displayCheckoutError(o,String(c).replace("%s",t.error||"")))})).fail((r=>{console.warn(r),e("#order_review").unblock(),AirwallexClient.displayCheckoutError(o,String(c).replace("%s",r.message||""))})))}))},s=r=>{setTimeout((function(){e(r).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}),50)},x=(r,t)=>{if(s("form.checkout"),!r||r.error)return AirwallexClient.displayCheckoutError(o,String(c).replace("%s","")),void e("form.checkout").unblock();let n=a;n+=n.includes("?")?"&":"?",n+="order_id="+r.orderId+"&intent_id="+r.paymentIntent,r.createConsent?Airwallex.createPaymentConsent({intent_id:r.paymentIntent,customer_id:r.customerId,client_secret:r.clientSecret,currency:r.currency,element:t,next_triggered_by:"merchant",billing:AirwallexClient.getBillingInformation()}).then((e=>{location.href=n})).catch((r=>{console.warn(r),e("form.checkout").unblock(),AirwallexClient.displayCheckoutError(o,String(c).replace("%s",r.message||""))})):Airwallex.confirmPaymentIntent({element:t,intent_id:r.paymentIntent,client_secret:r.clientSecret,payment_method:{card:{name:AirwallexClient.getCardHolderName()},billing:AirwallexClient.getBillingInformation()}}).then((e=>{location.href=n})).catch((r=>{console.warn(r),e("form.checkout").unblock(),AirwallexClient.displayCheckoutError(o,String(c).replace("%s",r.message||""))}))};awxCommonData&&((e,r,t)=>{const a=setInterval((()=>{window.Airwallex&&(clearInterval(a),Airwallex.init({env:e,locale:r,origin:window.location.origin}),t())}),1e3)})(r,t,d)}))})();