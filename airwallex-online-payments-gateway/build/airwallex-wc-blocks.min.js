(()=>{"use strict";var e={20:(e,t,n)=>{
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(609),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:d,props:o,_owner:i.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},848:(e,t,n)=>{e.exports=n(20)},609:e=>{e.exports=window.React}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const r=window.wc.wcBlocksRegistry,a=window.wc.wcSettings,o=window.wp.i18n;var s=n(609);const i=window.jQuery;var l=n.n(i);const c=(e,t)=>t.ajaxUrl.toString().replace("%%endpoint%%","airwallex_"+e),d=e=>l().ajax({url:awxCommonData.updateOrderStatusAfterPaymentDecline.url+"&security="+awxCommonData.updateOrderStatusAfterPaymentDecline.nonce+"&order_id="+e,method:"GET",dataType:"json"});var u,m,y,p,x=n(848);const w=(0,a.getSetting)("airwallex_main_data",{}),g=null!==(u=w?.title)&&void 0!==u?u:(0,o.__)("Pay with cards and more","airwallex-online-payments-gateway"),h=null!==(m=w?.description)&&void 0!==m?m:"",v=()=>{const[e,t]=(0,s.useState)({}),[n,r]=(0,s.useState)(0);return(0,s.useEffect)((()=>{l().ajax({url:awxCommonData.getApmData.url+"&security="+awxCommonData.getApmData.nonce,method:"GET",dataType:"json"}).then((({data:e})=>{t(e?.active_logos),r(e?.max_number_of_logos||0)}))}),[]),{logos:e,maxInlineLogoCount:n}},_=({logos:e})=>(0,x.jsx)(x.Fragment,{children:Object.entries(e).map((([e,t])=>(0,x.jsx)("img",{src:t,alt:g,className:"airwallex-card-icon"},e)))}),f=e=>{const{PaymentMethodLabel:t}=e.components,{logos:n,maxInlineLogoCount:r}=v();return Object.keys(n).length<=r?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(t,{text:g}),(0,x.jsx)("span",{style:{marginLeft:"auto",display:"flex",direction:"rtl"},children:(0,x.jsx)(_,{logos:n})})]}):(0,x.jsx)(t,{text:g})},C=e=>{const{logos:t,maxInlineLogoCount:n}=v();return Object.keys(t).length>n?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"airwallex-logo-list",style:{display:"flex"},children:(0,x.jsx)(_,{logos:t})}),(0,x.jsx)("div",{children:h})]}):(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{children:h})})},b={name:null!==(y=w?.name)&&void 0!==y?y:"airwallex_main",label:(0,x.jsx)(f,{}),content:(0,x.jsx)(C,{}),edit:(0,x.jsx)(C,{}),canMakePayment:()=>{var e;return null!==(e=w?.enabled)&&void 0!==e&&e},ariaLabel:g,supports:{features:null!==(p=w?.supports)&&void 0!==p?p:[]}},j={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",dev:"checkout-dev.airwallex.com",local:"localhost:3000"},S=e=>`https://${j[e]||j.prod}`,E="/assets/elements.bundle.min.js?version=1.89.0",k=e=>{const t=document.createElement("script");t.src=`${e}${E}`,t.crossOrigin="anonymous";const n=document.head||document.body;if(!n)throw new Error("Airwallex payment scripts requires a <head> or <body> html element in order to be loaded.");return n.appendChild(t),t},I=async e=>{if("undefined"==typeof window)return null;if(window.Airwallex)return window.Airwallex;let t=0;const n=async()=>{const t=document.querySelector(`script[src="${E}"], script[src="${E}/"]`)||k(S((null==e?void 0:e.env)||"prod"));return new Promise(((n,r)=>{t.addEventListener("load",(()=>{window.Airwallex?(window.Airwallex.init(e),n(window.Airwallex)):r(new Error("Failed to load Airwallex on load event"))})),t.addEventListener("error",(()=>{r(new Error("Failed to load Airwallex scripts")),t.remove&&t.remove()}))}))};for(;t<3;)try{return await n()}catch(e){t++,await new Promise((e=>window.setTimeout(e,500)))}return null},T=(e,t)=>window.Airwallex?window.Airwallex.createElement(e,t):(console.error("Please loadAirwallex() before createElement();"),null),M=e=>window.Airwallex?window.Airwallex.getElement(e):(console.error("Please loadAirwallex() before getElement();"),null),P=async e=>{if(window.Airwallex)return window.Airwallex.confirmPaymentIntent(e);{const e="Please loadAirwallex() before confirmPaymentIntent();";throw console.error(e),new Error(e)}},N=async e=>{if(window.Airwallex)return window.Airwallex.createPaymentConsent(e);{const e="Please loadAirwallex() before createPaymentConsent();";throw console.error(e),new Error(e)}};const R=e=>e.first_name.concat(" ",e.last_name).trim(),A=e=>({address:{city:e.city,country_code:e.country,postcode:e.postcode,state:e.state,street:e.address_1.concat(" ",e.address_2).trim()},first_name:e.first_name,last_name:e.last_name,email:e.email}),$=function(e,t){for(const n in t)e=e.split(n).join(t[n]);return e};(()=>{const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))})();const L=()=>{const e=navigator.language||navigator.userLanguage,t=e.split("-")[0];return"zh"!==t||"zh-HK"!==e&&"zh-TW"!==e?t:"zh-HK"},O=({settings:e,paymentDetails:t,cvcElementRef:n,billingData:r,successType:a,errorType:o,errorContext:s})=>{const i=document.getElementById("airwallex-save")?.checked,l=e.confirm_url.includes("?")?"&":"?",c=`${e.confirm_url}${l}order_id=${t.orderId}&intent_id=${t.paymentIntent}&is_airwallex_save_checked=${i}`,d=M("card"),u={type:a};let m;if(u.confirmUrl=c,t.paymentMethodId){let a={client_secret:t.clientSecret,billing:A(r),customer_id:t.customerId,intent_id:t.paymentIntent,payment_method_id:t.paymentMethodId,payment_method_options:{card:{auto_capture:e.capture_immediately}}};t.createConsent&&(a.currency=t.currency,a.payment_consent={merchant_trigger_reason:"scheduled",next_triggered_by:"merchant"}),m=n.current.confirm(a)}else m=t.createConsent?P({intent_id:t.paymentIntent,customer_id:t.customerId,client_secret:t.clientSecret,currency:t.currency,element:d,payment_consent:{merchant_trigger_reason:"scheduled",next_triggered_by:"merchant"},billing:A(r)}):i?N({intent_id:t.paymentIntent,customer_id:t.customerId,client_secret:t.clientSecret,currency:t.currency,element:d,next_triggered_by:"customer",billing:A(r)}):P({element:d,id:t.paymentIntent,client_secret:t.clientSecret,payment_method:{card:{name:R(r)},billing:A(r)}});return m.then((e=>u)).catch((e=>{var n;return u.type=o,u.code=e.code,u.message=null!==(n=e.message)&&void 0!==n?n:JSON.stringify(e),u.messageContext=s,u.orderId=t.orderId,u}))},D=({settings:e,props:t})=>{const[n,r]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),{emitResponse:y,billing:p}=t,{ValidationInputError:w,LoadingMask:g}=t.components,{onCheckoutSuccess:h,onPaymentSetup:v,onCheckoutFail:_,onCheckoutValidation:f}=t.eventRegistration;return(0,s.useEffect)((()=>{let t={env:e.environment,origin:window.location.origin,locale:e.locale};I(t).then((()=>{Airwallex.init(t);T("card",{autoCapture:e.capture_immediately,allowedCardNetworks:["discover","visa","mastercard","maestro","unionpay","amex","jcb","diners"],style:{base:{fontSize:"14px","::placeholder":{color:"rgba(135, 142, 153, 1)"}}}}).mount("airwallex-card")}));const n=e=>{r(!0),console.log("The Card element is ready.")},a=e=>{const{error:t}=e.detail;i(t.message),console.error("There was an error",t)},o=e=>{m("")},s=e=>{var t;const{error:n}=e.detail;m(null!==(t=n?.message)&&void 0!==t?t:JSON.stringify(n))},l=document.getElementById("airwallex-card");return l.addEventListener("onReady",n),l.addEventListener("onError",a),l.addEventListener("onBlur",s),l.addEventListener("onFocus",o),()=>{l.removeEventListener("onReady",n),l.removeEventListener("onError",a),l.removeEventListener("onFocus",o),l.removeEventListener("onBlur",s)}}),[]),(0,s.useEffect)((()=>{const e=f((()=>!u||{errorMessage:(0,o.__)("An error has occurred. Please check your payment details.","airwallex-online-payments-gateway")+` (${u})`}));return()=>{e()}}),[u,f]),(0,s.useEffect)((()=>{const e=v((async()=>({type:y.responseTypes.SUCCESS,meta:{paymentMethodData:{"is-airwallex-card-block":!0}}})));return()=>{e()}}),[e,v,y.responseTypes.SUCCESS]),(0,s.useEffect)((()=>{const e=_((({processingResponse:e})=>!e?.paymentDetails?.errorMessage||{type:y.responseTypes.ERROR,message:e.paymentDetails.errorMessage,messageContext:y.noticeContexts.PAYMENTS}));return()=>{e()}}),[_,y.noticeContexts.PAYMENTS,y.responseTypes.ERROR]),(0,s.useEffect)((()=>{const t=h((async({processingResponse:t})=>{c(!0);const n=t.paymentDetails||{},r=await O({settings:e,paymentDetails:n,billingData:p.billingData,successType:y.responseTypes.SUCCESS,errorType:y.responseTypes.ERROR,errorContext:y.noticeContexts.PAYMENTS});if(r.type!==y.responseTypes.SUCCESS&&(r.type!==y.responseTypes.ERROR||"invalid_status_for_operation"!==r.code)){try{let e=await d(r.orderId),t=!1===e?.success?e?.message:r.message;r.message=t}catch(e){let t=e.responseText;e.responseJSON&&e.responseJSON.message&&(t=e.responseJSON.message),r.message=t}return c(!1),r}location.href=r.confirmUrl}));return()=>{t()}}),[h,y.noticeContexts.PAYMENTS,y.responseTypes.SUCCESS,y.responseTypes.ERROR]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"airwallex-checkout-loading-mask",style:{display:l?"block":"none"}}),(0,x.jsx)("div",{id:"airwallex-card",style:{display:n?"flex":"none",border:"1px solid var(--Border-decorative, rgba(232, 234, 237, 1))",background:"rgb(250, 250, 251)",padding:"0 16px",marginBottom:"6px",marginTop:"4px",minHeight:"40px",borderRadius:"4px",alignItems:"center",width:"400px"}}),(0,x.jsx)(w,{errorMessage:u})]})},B=e=>{const[t,n]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[i,l]=(0,s.useState)(3),{emitResponse:c,settings:u,billing:m,token:y}=e,{onCheckoutSuccess:p}=e.eventRegistration,w=(0,s.useRef)(null),g=e=>{n(e.detail.complete)};return(0,s.useEffect)((()=>{const{tokens:e}=u,t=e?.[y];a(t?.is_hide_cvc_element),l(["amex","american express"].includes(t?.type?.toLowerCase())?4:3)}),[y,u]),(0,s.useEffect)((()=>{let e,t={env:u.environment,locale:u.locale,origin:window.location.origin};return I(t).then((()=>{Airwallex.init(t),e=Airwallex.createElement("cvc",{style:{base:{fontSize:"14px","::placeholder":{color:"rgba(135, 142, 153, 1)"}}},placeholder:(0,o.__)("CVC","airwallex-online-payments-gateway"),cvcLength:i}),w.current=e,n(!1),e.mount("airwallex-cvc"),e.on("change",g)})),()=>{e&&e.destroy()}}),[i]),(0,s.useEffect)((()=>{const e=p((async({processingResponse:e})=>{const{tokens:n}=u,r=n?.[y];if(!awxEmbeddedCardData.isSkipCVCEnabled&&!t&&!r?.is_hide_cvc_element)return{type:c.responseTypes.ERROR,message:awxEmbeddedCardData.CVCIsNotCompletedMessage,messageContext:c.noticeContexts.PAYMENTS};const a=e.paymentDetails||{},o=await O({settings:u,paymentDetails:a,cvcElementRef:w,billingData:m.billingData,successType:c.responseTypes.SUCCESS,errorType:c.responseTypes.ERROR,errorContext:c.noticeContexts.PAYMENTS});if(o.type!==c.responseTypes.SUCCESS&&(o.type!==c.responseTypes.ERROR||"invalid_status_for_operation"!==o.code)){try{let e=await d(o.orderId),t=!1===e?.success?e?.message:o.message;o.message=t}catch(e){let t=e.responseText;e.responseJSON&&e.responseJSON.message&&(t=e.responseJSON.message),o.message=t}return o}location.href=o.confirmUrl+"&token_id="+parseInt(y)}));return()=>e()}),[p,c.responseTypes.SUCCESS,c.responseTypes.ERROR,t,y]),(0,x.jsxs)("div",{style:{display:r?"none":"block"},children:[(0,x.jsx)("div",{className:"cvc-title",style:{marginBottom:"4px"},children:"Security code"}),(0,x.jsx)("div",{id:"airwallex-cvc",className:"cvc-container",style:{border:"1px solid var(--Border-decorative, rgba(232, 234, 237, 1))",background:"rgb(250, 250, 251)",padding:"0 16px",marginBottom:"18px",minHeight:"40px",borderRadius:"4px",display:"flex",alignItems:"center",width:"288px"}})]})};var U,F;const q=(0,a.getSetting)("airwallex_card_data",{}),Y=q?.title||(0,o.__)("Card","airwallex-online-payments-gateway"),W=q?.description,H=(0,o.__)("Card information","airwallex-online-payments-gateway"),J=(0,o.__)("Save payment information to my account for future purchases","airwallex-online-payments-gateway"),z=e=>{const{PaymentMethodLabel:t}=e.components,[n,r]=(0,s.useState)({});return(0,s.useEffect)((()=>{l().ajax({url:awxCommonData.getCardData.url+"&security="+awxCommonData.getCardData.nonce,method:"GET",dataType:"json"}).then((e=>{e.data?.logos&&r(e.data.logos)}))}),[]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(t,{text:Y}),(0,x.jsx)("span",{style:{marginLeft:"auto",display:"flex",direction:"rtl"},children:Object.entries(n).map((([e,t])=>(0,x.jsx)("img",{src:t,alt:Y,className:"airwallex-card-icon",style:{marginRight:"5px"}},e)))})]})},K=e=>{if(!1===q?.enabled)return null;return"inline"==q.checkout_form_type?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{color:"rgba(20, 23, 26, 1)"},children:H}),W&&(0,x.jsx)("p",{children:W}),(0,x.jsx)(D,{settings:q,props:e}),q.is_logged_in&&q.is_save_card_enabled&&!q.is_subscription&&(0,x.jsxs)("div",{className:"line save",children:[(0,x.jsx)("input",{type:"checkbox",id:"airwallex-save"}),(0,x.jsx)("label",{htmlFor:"airwallex-save",style:{color:"rgba(20, 23, 26, 1)",marginLeft:"6px"},children:J})]})]}):(0,x.jsx)("div",{children:W})},V={name:null!==(U=q?.name)&&void 0!==U?U:"airwallex_card",label:(0,x.jsx)(z,{}),content:(0,x.jsx)(K,{}),edit:(0,x.jsx)(K,{}),savedTokenComponent:(0,x.jsx)(B,{settings:q}),canMakePayment:()=>{var e;return null!==(e=q?.enabled)&&void 0!==e&&e},ariaLabel:Y,supports:{features:null!==(F=q?.supports)&&void 0!==F?F:[]}};var G,Z,Q,X;const ee=(0,a.getSetting)("airwallex_wechat_data",{}),te=null!==(G=ee?.title)&&void 0!==G?G:(0,o.__)("WeChat Pay","airwallex-online-payments-gateway"),ne=null!==(Z=ee?.description)&&void 0!==Z?Z:"",re=e=>{const{PaymentMethodLabel:t}=e.components;return(0,x.jsx)(t,{text:te})},ae=e=>(0,x.jsx)("div",{children:ne}),oe={name:null!==(Q=ee?.name)&&void 0!==Q?Q:"airwallex_wechat",label:(0,x.jsx)(re,{}),content:(0,x.jsx)(ae,{}),edit:(0,x.jsx)(ae,{}),canMakePayment:()=>{var e;return null!==(e=ee?.enabled)&&void 0!==e&&e},ariaLabel:te,supports:{features:null!==(X=ee?.supports)&&void 0!==X?X:[]}};var se,ie,le,ce;const de=(0,a.getSetting)("airwallex_pos_data",{}),ue=null!==(se=de?.title)&&void 0!==se?se:(0,o.__)("POS","airwallex-online-payments-gateway"),me=null!==(ie=de?.description)&&void 0!==ie?ie:"",ye=e=>{const{PaymentMethodLabel:t}=e.components;return(0,x.jsx)(t,{text:ue})},pe=e=>(0,x.jsx)("div",{children:me}),xe={name:null!==(le=de?.name)&&void 0!==le?le:"airwallex_pos",label:(0,x.jsx)(ye,{}),content:(0,x.jsx)(pe,{}),edit:(0,x.jsx)(pe,{}),canMakePayment:()=>{var e;return null!==(e=de?.enabled)&&void 0!==e&&e},ariaLabel:ue,supports:{features:null!==(ce=de?.supports)&&void 0!==ce?ce:[]}},we=(0,o.__)("Express Checkout","airwallex-online-payments-gateway"),ge=e=>{const{PaymentMethodLabel:t}=e.components;return(0,x.jsx)(t,{text:we})},he=e=>(0,x.jsx)("div",{children:""}),ve={name:"airwallex_express_checkout",label:(0,x.jsx)(ge,{}),content:(0,x.jsx)(he,{}),edit:(0,x.jsx)(he,{}),canMakePayment:()=>!1,ariaLabel:we,supports:{features:[]}},_e=window.wp.data,fe=window.wc.wcBlocksData,Ce=({title:e,icon:t,...n})=>{const{PaymentMethodLabel:r}=n.components,{url:a,alt:o}=t;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(r,{text:e}),(0,x.jsx)("img",{src:a,alt:o,style:{marginLeft:"auto",marginRight:"5px"}})]})},be=({settings:e,description:t,CustomPaymentComponent:n=null,...r})=>{const{eventRegistration:a,emitResponse:i,billing:d,activePaymentMethod:u}=r,{LoadingMask:m}=r.components,{onCheckoutValidation:y,onPaymentSetup:p,onCheckoutFail:w}=a,{currency:g}=d,{paymentMethodName:h,paymentMethodDocURL:v}=e,{currencyIneligibleCWOff:_,currencyIneligibleCWOn:f}=e.textTemplate,{criticalIcon:C,infoIcon:b}=e.alterBoxIcons,[j,S]=(0,s.useState)(!1),[E,k]=(0,s.useState)(!1),[I,T]=(0,s.useState)(!1),[M,P]=(0,s.useState)(!1),[N,R]=(0,s.useState)(!1),[A,O]=(0,s.useState)(""),[D,B]=(0,s.useState)({}),[U,F]=(0,s.useState)(!1),q=(0,s.useRef)(!1),Y=async t=>{let n=!1,r="",a="";J(!0),R(!0),await((e,t,n)=>l().ajax({type:"POST",data:{payment_currency:e,target_currency:t,security:n?.nonce?.createQuoteCurrencySwitcher},url:c("currency_switcher_create_quote",n)}))(g.code,t,e).then((o=>{const{quote:s}=o;if(s){B(s),n=!0;const o={$$payment_method_name$$:h,$$original_currency$$:s.paymentCurrency,$$converted_currency$$:s.targetCurrency,$$conversion_rate$$:s.clientRate,$$converted_amount$$:s.targetAmount};r=$(e?.textTemplate?.conversionRate,o),a=$(e?.textTemplate?.convertedAmount,o),W({paymentMethodName:h,conversionRate:r,convertedAmount:a,requiredCurrency:t,baseAmount:s.paymentAmount}),P(!0),T(!1),J(!1)}else n=!1,r="",a="",P(!1),T(!0),J(!0)})).catch((e=>{P(!1),T(!0),console.error(e)})),R(!1),J(!1),document.getElementById("wc-block-airwallex-currency-switching-convert-rate").innerHTML=r,document.getElementById("wc-block-airwallex-currency-switching-converted-amount").innerHTML=a,document.getElementById("wc-block-airwallex-currency-switching-container").style.display=n?"flex":"none"},W=({paymentMethodName:e,conversionRate:t,convertedAmount:n,requiredCurrency:r,baseAmount:a})=>{try{document.getElementById("wc-airwallex-quote-expire-convert-text").innerHTML=$(f,{$$payment_method_name$$:e,$$original_currency$$:g.code,$$converted_currency$$:r}),document.getElementById("wc-airwallex-currency-switching-base-amount").innerHTML=a,document.getElementById("wc-airwallex-currency-switching-conversion-rate").innerHTML=t,document.getElementById("wc-airwallex-currency-switching-converted-amount").innerHTML=n}catch(e){console.warn(e)}},H=()=>{try{document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire")[0].style.display="none",document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire-mask")[0].style.display="none"}catch(e){console.warn(e)}},J=function(e){try{document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire-place-order-mask")[0].style.display=e?"block":"none"}catch(e){console.warn(e)}};return(0,s.useEffect)((()=>{const t=document.getElementById("wc-block-airwallex-currency-switching-container");t&&(t.style.display="none"),"function"==typeof r.handleCurrencySwitching&&r.handleCurrencySwitching({country:d.billingAddress.country,currency:g,settings:e,paymentMethod:u,updateCurrencySwitchingInfo:Y,setShowEntityIneligible:S,setShowCountryIneligible:k,setShowCurrencyIneligibleCWOff:T,setShowCurrencyIneligibleCWOn:P,setConvertCurrency:O,setShowCustomPaymentComponent:F});try{document.getElementById("wc-airwallex-quote-expire-confirm").innerHTML=document.getElementsByClassName("wc-block-components-checkout-place-order-button")[0]?.innerText}catch(e){console.warn(e)}}),[d.billingAddress.country,d.cartTotal.value]),(0,s.useEffect)((()=>{const e=y((()=>(q.current=!1,j?{context:i.noticeContexts.PAYMENTS,errorMessage:(0,o.__)("Invalid merchant entity.","airwallex-online-payments-gateway")}:E||I?{context:i.noticeContexts.PAYMENTS,errorMessage:(0,o.__)("Please use a different payment method.","airwallex-online-payments-gateway")}:0===Object.keys(D).length||(!!(D&&D.refreshAt&&new Date(D.refreshAt).getTime()>=(new Date).getTime())||(Y(A),(()=>{try{document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire")[0].style.display="block",document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire-mask")[0].style.display="block"}catch(e){console.warn(e)}})(),new Promise(((e,t)=>{const n=document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire-close")[0],r=document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire-place-back")[0],a=document.getElementsByClassName("wc-airwallex-currency-switching-quote-expire-place-order")[0];n&&r&&a||(console.warn("Quote expire pop up modal not found."),e(!1)),n.onclick=()=>{H(),q.current=!0,e({context:i.noticeContexts.PAYMENTS,errorMessage:(0,o.__)("Payment aborted.","airwallex-online-payments-gateway")})},r.onclick=()=>{H(),q.current=!0,e({context:i.noticeContexts.PAYMENTS,errorMessage:(0,o.__)("Payment aborted.","airwallex-online-payments-gateway")})},a.onclick=()=>{H(),e(!0)}})))))));return()=>{e()}}),[j,E,I,D,A,y]),(0,s.useEffect)((()=>{const e=p((async()=>{const e=(e=>{const{navigator:t,screen:n}=window||{},{language:r,userAgent:a}=t||{},{colorDepth:o,height:s,width:i}=n||{};return{device_id:e,screen_height:s,screen_width:i,screen_color_depth:o,language:r,timezone:(new Date).getTimezoneOffset(),browser:{java_enabled:t?.javaEnabled(),javascript_enabled:!0,user_agent:a}}})(document.getElementById("airwallex-fraud-api")?.getAttribute("data-order-session-id"));return{type:i.responseTypes.SUCCESS,meta:{paymentMethodData:{is_payment_aborted:q.current?"true":"false",airwallex_device_data:JSON.stringify(e),airwallex_target_currency:A,airwallex_browser_language:L()}}}}));return()=>{e()}}),[e,A,p,i.responseTypes.SUCCESS]),(0,s.useEffect)((()=>{const e=w((({processingResponse:e})=>!e?.paymentDetails?.message||{type:i.responseTypes.ERROR,message:e.paymentDetails.message,messageContext:i.noticeContexts.PAYMENTS}));return()=>{e()}}),[w,i.noticeContexts.PAYMENTS,i.responseTypes.ERROR]),(0,x.jsx)("div",{children:(0,x.jsxs)(m,{isLoading:N,screenReaderLabel:(0,o.__)("Loading currency switching detail…","airwallex-online-payments-gateway"),children:[t,(0,x.jsx)("span",{style:{display:N?"inline-block":"none"},className:"wc-airwallex-loader"}),(0,x.jsx)(Se,{shouldDisplay:j,icon:C}),(0,x.jsx)(Ee,{shouldDisplay:E,methodName:h,docUrl:v,icon:C,test:N}),n&&U&&(0,x.jsx)(n,{paymentMethod:u,currency:g,setConvertCurrency:O,setShowCurrencyIneligibleCWOn:P,updateCurrencySwitchingInfo:Y,disablePlaceOrderButton:function(e){try{e?document.getElementsByClassName("wc-block-components-checkout-place-order-button")[0].setAttribute("disabled","disabled"):document.getElementsByClassName("wc-block-components-checkout-place-order-button")[0].removeAttribute("disabled")}catch(e){console.warn(e)}}}),(0,x.jsx)(ke,{shouldDisplay:I,text:$(_,{$$payment_method_name$$:h,$$original_currency$$:g.code}),icon:C}),(0,x.jsx)(Ie,{shouldDisplay:M,text:$(f,{$$payment_method_name$$:h,$$original_currency$$:g.code,$$converted_currency$$:A}),icon:b})]})})},je=({description:e,...t})=>(0,x.jsx)("div",{children:e}),Se=({icon:e,shouldDisplay:t})=>(0,x.jsxs)("div",{style:{display:t?"flex":"none"},className:"wc-airwallex-alert-box wc-airwallex-error",children:[(0,x.jsx)("img",{src:e}),(0,x.jsx)("div",{children:(0,o.__)("Invalid merchant entity.","airwallex-online-payments-gateway")})]}),Ee=({methodName:e,docUrl:t,icon:n,shouldDisplay:r,test:a})=>(0,x.jsxs)("div",{style:{display:r?"flex":"none"},className:"wc-airwallex-alert-box wc-airwallex-error",children:[(0,x.jsx)("img",{src:n}),(0,x.jsxs)("div",{children:[e,(0,o.__)(" is not available in your country. Please change your billing address to a ","airwallex-online-payments-gateway"),(0,x.jsx)("a",{href:t,target:"_blank",children:(0,o.__)("compatible country","airwallex-online-payments-gateway")}),(0,o.__)(" or choose a different payment method.","airwallex-online-payments-gateway")]})]}),ke=({text:e,icon:t,shouldDisplay:n})=>(0,x.jsxs)("div",{style:{display:n?"flex":"none"},className:"wc-airwallex-alert-box wc-airwallex-error",children:[(0,x.jsx)("img",{src:t}),(0,x.jsx)("div",{children:e})]}),Ie=({text:e,icon:t,shouldDisplay:n})=>(0,x.jsxs)("div",{style:{display:n?"flex":"none"},className:"wc-airwallex-alert-box wc-airwallex-info",children:[(0,x.jsx)("img",{src:t}),(0,x.jsx)("div",{children:e})]});var Te,Me,Pe,Ne,Re;const Ae=(0,a.getSetting)("airwallex_klarna_data",{}),$e=null!==(Te=Ae.icon)&&void 0!==Te?Te:{},Le=null!==(Me=Ae?.title)&&void 0!==Me?Me:(0,o.__)("Klarna","airwallex-online-payments-gateway"),Oe=null!==(Pe=Ae?.description)&&void 0!==Pe?Pe:"",De={name:null!==(Ne=Ae?.name)&&void 0!==Ne?Ne:"airwallex_klarna",label:(0,x.jsx)(Ce,{title:Le,icon:$e}),content:(0,x.jsx)(be,{settings:Ae,description:Oe,paymentMethodName:Le,handleCurrencySwitching:({country:e,currency:t,settings:n,paymentMethod:r,updateCurrencySwitchingInfo:a,setShowEntityIneligible:o,setShowCountryIneligible:s,setShowCurrencyIneligibleCWOff:i,setShowCurrencyIneligibleCWOn:l,setConvertCurrency:c})=>{if(!n[r])return;const{availableCurrencies:d}=n,{supportedCountryCurrency:u}=n[r];if(u&&e in u){const n=u[e];return c(n),void(t.code===n?(s(!1),i(!1),l(!1)):d&&d.includes(n)?(a(n),s(!1)):(s(!1),i(!0),l(!1)))}s(!0),i(!1),l(!1)}}),edit:(0,x.jsx)(je,{description:Oe}),canMakePayment:()=>{var e;return null!==(e=Ae?.enabled)&&void 0!==e&&e},ariaLabel:Le,supports:{features:null!==(Re=Ae?.supports)&&void 0!==Re?Re:[]}};var Be,Ue,Fe,qe,Ye;const We=(0,a.getSetting)("airwallex_afterpay_data",{}),He=null!==(Be=We.icon)&&void 0!==Be?Be:{},Je=null!==(Ue=We?.title)&&void 0!==Ue?Ue:(0,o.__)("Afterpay","airwallex-online-payments-gateway"),ze=null!==(Fe=We?.description)&&void 0!==Fe?Fe:"",Ke=[{code:"US",name:"United States"},{code:"AU",name:"Australia"},{code:"NZ",name:"New Zealand"},{code:"GB",name:"United Kingdom"},{code:"CA",name:"Canada"}],Ve="airwallex_afterpay_country",Ge=function(e,t,n,r,a){const o=localStorage.getItem(Ve)||"";if(!o)return!1;const s=e?.[o];if(!s)return!1;if(t(s),n!==s)r(s),a(!0);else{const e=document.getElementById("wc-block-airwallex-currency-switching-container");e&&(e.style.display="none"),a(!1)}return!0},Ze={name:null!==(qe=We?.name)&&void 0!==qe?qe:"airwallex_afterpay",label:(0,x.jsx)(Ce,{title:Je,icon:He}),content:(0,x.jsx)(be,{settings:We,description:ze,paymentMethodName:Je,handleCurrencySwitching:({country:e,currency:t,settings:n,paymentMethod:r,updateCurrencySwitchingInfo:a,setShowEntityIneligible:o,setShowCountryIneligible:s,setShowCurrencyIneligibleCWOff:i,setShowCurrencyIneligibleCWOn:l,setConvertCurrency:c,setShowCustomPaymentComponent:d})=>{if(!n[r])return;const{availableCurrencies:u,owningEntity:m}=n,{supportedCountryCurrency:y,supportedEntityCurrencies:p}=n[r],x=t.code,w=e;d(!1),o(!1),s(!1),i(!1),l(!1);const g=p?.[m];if(!g)return o(!0),!1;if((!u||!u.length)&&g.includes(x))return!0;const h=y?.[w];if(g.includes(x)&&("AIRWALLEX_HK"!==m||h===x))return!0;let v;return h&&(v=h,g.includes(v)||(v="")),v||1!==g.length||(v=g[0]),v?(c(v),a(v),l(!0),!0):(d(!0),Ge(y,c,x,a,l))},CustomPaymentComponent:({paymentMethod:e,currency:t,setConvertCurrency:n,setShowCurrencyIneligibleCWOn:r,updateCurrencySwitchingInfo:a,disablePlaceOrderButton:i})=>{const{supportedCountryCurrency:l}=We[e],[c,d]=(0,s.useState)((()=>localStorage.getItem(Ve)||"")),[u,m]=(0,s.useState)(!1);(0,s.useEffect)((()=>{Ge(l,n,t.code,a,r)}),[c]);return(0,x.jsxs)("div",{className:"wc-airwallex-afterpay-supported-countries-form",children:[(0,x.jsx)("div",{className:"awx-choose-afterpay-region-title",children:(0,o.__)("Choose your Afterpay account region","airwallex-online-payments-gateway")}),(0,x.jsx)("div",{style:{margin:"10px 0"},children:(0,o.__)("If you don’t have an account yet, choose the region that you will create your account from.","airwallex-online-payments-gateway")}),(0,x.jsxs)("div",{className:"awx-afterpay-countries",children:[(0,x.jsx)("div",{className:"input-icon",onClick:()=>m(!u),children:(0,x.jsx)("img",{src:We?.alterBoxIcons?.selectArrowIcon,alt:"arrow"})}),(0,x.jsx)("div",{children:(0,x.jsx)("input",{readOnly:!0,type:"text",placeholder:(0,o.__)("Afterpay account region","airwallex-online-payments-gateway"),value:c?Ke.find((e=>e.code===c))?.name:"",onFocus:()=>m(!0),onBlur:()=>setTimeout((()=>m(!1)),200)})}),u&&(0,x.jsx)("div",{className:"countries",children:(0,x.jsx)("ul",{children:Ke.map((e=>(0,x.jsx)("li",{"data-value":e.code,className:c===e.code?"selected":"",onClick:()=>{return t=e.code,d(t),localStorage.setItem(Ve,t),m(!1),void i(!1);var t},children:e.name},e.code)))})})]})]})}}),edit:(0,x.jsx)(je,{description:ze}),canMakePayment:()=>{var e;return null!==(e=We?.enabled)&&void 0!==e&&e},ariaLabel:Je,supports:{features:null!==(Ye=We?.supports)&&void 0!==Ye?Ye:[]}},Qe=window.wp.plugins,Xe=window.wc.blocksCheckout;(0,r.registerPaymentMethod)(b),(0,r.registerPaymentMethod)(V),(0,r.registerPaymentMethod)(oe),(0,r.registerPaymentMethod)(xe),(0,r.registerPaymentMethod)(ve),(0,r.registerPaymentMethod)(De),(0,r.registerPaymentMethod)(Ze);const et=({cart:e,extensions:t})=>(0,x.jsxs)("div",{id:"wc-block-airwallex-currency-switching-container",style:{display:"none"},children:[(0,x.jsx)("div",{style:{padding:"16px",flexGrow:"1"},children:(0,o.__)("You Pay","airwallex-online-payments-gateway")}),(0,x.jsxs)("div",{className:"wc-airwallex-currency-switching-container",children:[(0,x.jsxs)("div",{className:"wc-airwallex-currency-switching-conversion-rate",children:[(0,x.jsxs)("div",{className:"wc-airwallex-currency-switching-convert-icon",children:[(0,x.jsx)("div",{className:"wc-airwallex-currency-switching-convert-icon-line",children:(0,x.jsx)("div",{})}),(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:(0,x.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.8751 6.00603C11.2227 5.84685 11.641 5.97553 11.836 6.31338C12.0431 6.6721 11.9202 7.13079 11.5615 7.33789L9.93769 8.27539C9.57897 8.4825 9.12028 8.3596 8.91317 8.00088L7.97567 6.37708C7.76857 6.01836 7.89147 5.55967 8.25019 5.35256C8.60891 5.14545 9.0676 5.26836 9.27471 5.62708L9.36849 5.78951C9.25886 4.02452 7.79267 2.62695 6.00007 2.62695C5.0122 2.62695 4.12347 3.05137 3.50626 3.72782L2.44482 2.66638C3.33417 1.71884 4.598 1.12695 6.00007 1.12695C8.69245 1.12695 10.8751 3.30957 10.8751 6.00195C10.8751 6.00331 10.8751 6.00467 10.8751 6.00603ZM1.12576 6.08873L1.12513 6.0891C0.766406 6.2962 0.307713 6.1733 0.100606 5.81458C-0.106501 5.45586 0.0164058 4.99717 0.375125 4.79006L1.99892 3.85256C2.35764 3.64545 2.81633 3.76836 3.02344 4.12708L3.96094 5.75088C4.16805 6.1096 4.04514 6.56829 3.68642 6.77539C3.3277 6.9825 2.86901 6.8596 2.6619 6.50088L2.66152 6.50022C2.90238 8.12792 4.30533 9.37695 6 9.37695C6.85293 9.37695 7.63196 9.06056 8.22613 8.53874L9.28834 9.60095C8.42141 10.3935 7.26716 10.877 6 10.877C3.3366 10.877 1.17206 8.74108 1.12576 6.08873Z",fill:"#B0B6BF"})}),(0,x.jsx)("div",{className:"wc-airwallex-currency-switching-convert-icon-line",children:(0,x.jsx)("div",{})})]}),(0,x.jsx)("div",{id:"wc-block-airwallex-currency-switching-convert-rate",className:"wc-airwallex-currency-switching-convert-text"})]}),(0,x.jsx)("div",{id:"wc-block-airwallex-currency-switching-converted-amount",className:"wc-airwallex-currency-switching-converted-amount"})]})]});(0,Qe.registerPlugin)("airwallex-lpm",{render:()=>(0,x.jsx)(Xe.ExperimentalOrderMeta,{children:(0,x.jsx)(et,{})}),scope:"woocommerce-checkout"}),window.addEventListener("change",(e=>{"radio-control-wc-payment-method-options"!==e?.target?.name||["airwallex_klarna","airwallex_afterpay"].includes((0,_e.select)(fe.PAYMENT_STORE_KEY).getActivePaymentMethod())||(document.getElementById("wc-block-airwallex-currency-switching-container").style.display="none")}))})();